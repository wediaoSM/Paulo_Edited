<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Agenda de Eventos — Paulo Carrion (com Admin)</title>

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&family=Playfair+Display:wght@500;700&display=swap" rel="stylesheet">

  <!-- All styles (events.css + admin overrides) -->
  <style>
/* ---------- root & reset (kept) ---------- */
:root{
  --bg:#05060a; --panel:#071018; --muted:#9aa3ac; --accent:#00d07f; --accent-2:#00ff9b;
  --card:rgba(255,255,255,0.02); --glass:rgba(255,255,255,0.04); --radius:12px; --container:1100px;
  --gap:18px; --transition-fast:140ms; --transition-medium:260ms; --hero-height:420px;
  color-scheme:dark;
}
*{box-sizing:border-box}
html,body{height:100%;margin:0;font-family:"Inter",system-ui,-apple-system,"Segoe UI",Roboto,Arial;background:linear-gradient(180deg,#03040a 0%,#071018 100%);color:#e8f6f0;-webkit-font-smoothing:antialiased}
.container{max-width:var(--container);margin:0 auto;padding:0 18px}
.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}

/* ---------- HERO (kept) ---------- */
.site-hero{position:relative;min-height:var(--hero-height);overflow:visible;isolation:isolate;padding:28px 0 10px}
.hero-layer.hero-bg{position:absolute;inset:0;background-size:cover;background-position:center;transform:translateZ(0) scale(1.04);transition:transform 400ms ease-out,opacity 600ms ease;z-index:0;filter:saturate(1.05) contrast(0.95)}
.hero-overlay{position:absolute;inset:0;z-index:1;background:radial-gradient(60% 50% at 50% 30%, rgba(255,255,255,0.02) 0%, rgba(0,0,0,0.45) 45%, rgba(0,0,0,0.72) 100%);pointer-events:none}
.hero-panel{position:relative;z-index:3;margin-top:36px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.06));border-radius:14px;backdrop-filter:blur(8px) saturate(1.05);border:1px solid rgba(255,255,255,0.04);padding:20px;display:grid;grid-template-columns:1fr 360px;gap:22px;align-items:center;box-shadow:0 18px 48px rgba(0,0,0,0.6);margin-bottom:10px}
.hero-logo{height:64px;width:auto}
.hero-title{margin:0;font-family:"Playfair Display",serif;font-size:34px;color:#f6fff9}
.hero-text{color:var(--muted);margin:0;font-size:15px;max-width:680px}
.hero-actions{display:flex;gap:12px;margin-top:6px}
.btn{min-width:140px;transition:transform var(--transition-fast),box-shadow var(--transition-fast);background:linear-gradient(180deg, #9D7D56, #9D7D56);color:#fff;cursor:pointer;box-shadow:0 6px 12px rgba(0,0,0,0.35)}
.btn.ghost{background:transparent;border:1px solid rgba(255,255,255,0.04);color:var(--muted)}
.hero-right{display:flex;flex-direction:column;align-items:flex-end;gap:14px}
.stat{background:linear-gradient(180deg, rgba(255,255,255,0.015), rgba(0,0,0,0.02));padding:10px 14px;border-radius:10px;text-align:center;min-width:92px;border:1px solid rgba(255,255,255,0.03)}
.stat-num{font-weight:800;color:#f6fff9;font-size:18px}
.stat-label{color:var(--muted);font-size:12px;margin-top:4px}

/* ---------- MAIN CONTENT PANEL ---------- */
.content-panel{margin-top:24px;margin-bottom:36px;background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(0,0,0,0.02));border-radius:12px;padding:18px;border:1px solid rgba(255,255,255,0.03);backdrop-filter:blur(6px);box-shadow:0 16px 40px rgba(0,0,0,0.6)}
.controls-row{display:flex;gap:12px;align-items:center;justify-content:space-between;margin-bottom:12px}
.search input{height:44px;padding:10px 14px;border-radius:10px;border:1px solid rgba(255,255,255,0.04);background:rgba(255,255,255,0.02);color:inherit;min-width:260px;outline:none;transition:box-shadow 140ms,transform 140ms}
.search input:focus{box-shadow:0 6px 20px rgba(0,0,0,0.45);transform:translateY(-2px)}
.filters{display:flex;gap:10px;align-items:center}

/* ---------- custom select ---------- */
.select-wrap{position:relative;z-index:60}
.select-wrap select {
  appearance:none;
  height:42px;
  padding:8px 36px 8px 12px;
  border-radius:10px;
  border:1px solid rgba(255,255,255,0.04);
  background:#071018;   /* fundo sólido dark */
  color:#e8f6f0;        /* texto visível */
  outline:none;
  cursor:pointer;
  min-width:180px;
  position:relative;
}
.select-wrap select option {
  background:#071018;
  color:#e8f6f0;
}

/* ---------- AGENDA GRID ---------- */
.agenda-grid-wrap{padding-top:8px}
.agenda-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:var(--gap);align-items:start}
.card{background:linear-gradient(180deg, rgba(255,255,255,0.012), rgba(0,0,0,0.06));border-radius:var(--radius);overflow:hidden;border:1px solid rgba(255,255,255,0.03);display:flex;flex-direction:column;min-height:320px;box-shadow:0 14px 36px rgba(0,0,0,0.55);transition:transform 140ms,box-shadow 140ms}
.card-thumb{
  height:160px;
  background-size: 100% auto;
  background-position:center 18%;
  position:relative;
  background-repeat:no-repeat;
}
.card-body{padding:14px;display:flex;flex-direction:column;gap:10px;flex:1}
.meta{display:flex;justify-content:space-between;align-items:flex-start;gap:12px}
.city{font-weight:800;letter-spacing:.6px;font-size:13px}
.date{color:var(--muted);font-size:12px}
.desc{color:#dfeee6;font-size:14px;line-height:1.35}
.card-footer{display:flex;align-items:center;justify-content:space-between;padding:10px 14px;background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(0,0,0,0.02)); gap: 10px; /* separação consistente entre os botões */}
.price{font-weight:800;color:#f0fff8}
.badge{display:inline-block;padding:6px 10px;border-radius:999px;background:rgba(255,255,255,0.03);font-weight:700;font-size:12px;color:#dff7ea;border:1px solid rgba(255,255,255,0.03)}

/* Botões do card: layout e visual aprimorado */
.card-footer .btn {
  flex: 1;                 /* ambos ocupam a mesma largura */
  border-radius: 12px;
  font-weight: 800;
  padding: 11px 14px;
  transition: transform 140ms ease, filter 140ms ease, box-shadow 140ms ease;
}

/* Ver programação (botão primário — o da esquerda) */
.card-footer .btn:first-child {
  background: linear-gradient(180deg, #B69873 0%, #9D7D56 100%) !important;
  color: #fff !important;
  border: 1px solid rgba(255,255,255,0.08);
  text-shadow: 0 1px 0 rgba(0,0,0,0.25);
  box-shadow:
    0 10px 24px rgba(157,125,86,0.32),
    inset 0 1px 0 rgba(255,255,255,0.18),
    0 0 0 1px rgba(157,125,86,0.22);
  position: relative;
}

/* Ícone seta no primário */
.card-footer .btn:first-child::after {
  content: "›";
  margin-left: 8px;
  font-weight: 900;
  line-height: 1;
  transform: translateY(1px);
  opacity: .95;
}

/* Hover/active do primário */
.card-footer .btn:first-child:hover {
  transform: translateY(-1px);
  filter: brightness(1.06);
  box-shadow:
    0 14px 30px rgba(157,125,86,0.38),
    inset 0 1px 0 rgba(255,255,255,0.22),
    0 0 0 1px rgba(157,125,86,0.28);
}
.card-footer .btn:first-child:active {
  transform: translateY(0);
  filter: brightness(0.98);
}

/* Botão secundário (ghost) no footer do card */
.card-footer .btn.ghost {
  background: rgba(255,255,255,0.04) !important;
  border: 1px solid rgba(255,255,255,0.08) !important;
  color: #dfeee6 !important;
  box-shadow: inset 0 1px 0 rgba(255,255,255,0.05);
}
.card-footer .btn.ghost:hover {
  filter: brightness(1.05);
  transform: translateY(-1px);
}
.card-footer .btn.ghost:active {
  transform: translateY(0);
}

/* === Equalizar alturas dos cards (independente do conteúdo) === */
.agenda-grid {
  align-items: stretch; /* força os itens a ocuparem a mesma altura da linha */
}

.card {
  display: grid;                 /* substitui o flex para garantir layout fixo */
  grid-template-rows: auto 1fr auto; /* thumb | conteúdo flexível | footer */
  height: 100%;
}

.card-body {
  min-height: 0; /* permite o encolhimento correto dentro da célula 1fr */
}

.desc {
  display: -webkit-box;
  -webkit-line-clamp: 3;     /* mostra até 3 linhas */
  -webkit-box-orient: vertical;
  overflow: hidden;
  min-height: calc(1em * 1.35 * 3); /* reserva altura de 3 linhas para padronizar */
  word-break: break-word;
}

/* Opcional: se alguma badge/price for muito longa, evita quebra desproporcional */
.badge, .price { white-space: normal; word-break: break-word; }

/* ========== MODAL: REIMAGINED (scoped to #modal) ========== */
#modal{
  position:fixed;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  background: radial-gradient(1200px 400px at 50% 30%, rgba(0,0,0,0.60), rgba(0,0,0,0.78) 45%, rgba(2,6,10,0.92) 100%);
  z-index:220000 !important;
  padding:32px;
  backdrop-filter: blur(10px) saturate(1.05);
  -webkit-backdrop-filter: blur(10px);
  transition: background 260ms ease;
  will-change: background;
}
#modal.hidden{ display:none !important; }

#modal > .modal-panel{
  width:100%;
  max-width:1200px;
  max-height:92vh;
  background: linear-gradient(180deg, rgba(12,20,26,0.92), rgba(4,8,12,0.98));
  border-radius:20px;
  padding:0;
  position:relative;
  overflow:hidden;
  box-shadow:
    0 60px 160px rgba(2,6,10,0.9),
    0 18px 48px rgba(0,0,0,0.6),
    inset 0 1px 0 rgba(255,255,255,0.02);
  transform: translateY(18px) scale(.99);
  opacity: 0;
  transition: transform 360ms cubic-bezier(.2,.95,.25,1), opacity 320ms ease, box-shadow 320ms ease;
  border: 1px solid rgba(255,255,255,0.03);
  display:flex;
  flex-direction:column;
  align-items:stretch;
}

#modal.open > .modal-panel{
  transform: translateY(0) scale(1);
  opacity: 1;
}

#modal > .modal-panel > .modal-content{
  display:grid;
  grid-template-columns: minmax(360px,420px) 1fr;
  gap: 24px;
  padding: 28px;
  align-items:stretch;
  min-height: 420px;
  overflow: hidden;
}

#modal .modal-thumb{ width:100%; height:100%; min-height: 420px; background-size: cover; background-position: center; border-radius: 14px; position: relative; box-shadow: 0 24px 80px rgba(0,0,0,0.7); overflow: hidden; display:block; }

#modal > .modal-panel > .modal-content > .modal-body{
  padding:8px 6px 18px 6px;
  display:flex;
  flex-direction:column;
  gap:12px;
  color:#eafbf0;
  overflow:auto;
  max-height: calc(92vh - 60px);
}

#modal .modal-close{
  position:absolute;
  right:18px;
  top:18px;
  z-index:30;
  background:rgba(255,255,255,0.02);
  border:none;
  color:#e8fdf0;
  padding:10px;
  border-radius:10px;
  cursor:pointer;
  box-shadow:0 8px 20px rgba(0,0,0,0.6);
}

/* responsive: médio e pequeno */
@media (max-width:1200px){
  #modal > .modal-panel{ max-width:960px; }
  #modal > .modal-panel > .modal-content{ grid-template-columns: minmax(320px,380px) 1fr; min-height:360px; gap:20px; padding:20px; }
  #modal .modal-thumb{ min-height:360px; border-radius:12px; }
  #modal > .modal-panel > .modal-content > .modal-body{ max-height: calc(92vh - 64px); }
}

@media (max-width:900px){
  #modal > .modal-panel{ max-width:92%; border-radius:12px; padding:0; }
  #modal > .modal-panel > .modal-content{ grid-template-columns: 1fr; gap:12px; padding:12px; min-height:260px; }
  #modal .modal-thumb{ min-height:220px; width:100%; border-radius:10px; }
  #modal > .modal-panel > .modal-content > .modal-body{ max-height: none; }
  #modal .modal-close{ right:12px; top:12px; }
}

@media (max-width:560px){
  #modal{ padding:10px; }
  #modal > .modal-panel{ width:100%; height:100%; max-width:100%; max-height:100%; border-radius:10px; }
  #modal > .modal-panel > .modal-content{ padding:8px; min-height:100%; grid-template-columns:1fr; gap:10px; }
  #modal .modal-thumb{ min-height:220px; }
  #modal > .modal-panel > .modal-content > .modal-body{ max-height: none; overflow:auto; padding-bottom:12px; }
  #modal .modal-actions .btn{ width:100%; }
}

/* ===== Modal — refinamentos mobile (768 / 600 / 400) ===== */
@media (max-width: 768px) {
  #modal > .modal-panel {
    max-width: 82% !important;     /* antes 86% */
    max-height: 84vh !important;    /* antes 88vh */
  }
  #modal > .modal-panel > .modal-content {
    gap: 10px !important;           /* antes 12px */
    padding: 12px !important;       /* antes 14px */
    min-height: 220px !important;   /* antes 240px */
  }
  #modal .modal-thumb { min-height: 180px !important; } /* antes 200px */
}

@media (max-width: 600px) {
  #modal > .modal-panel {
    max-width: 88% !important;      /* antes 92% */
    max-height: 84vh !important;    /* antes 88vh */
    height: auto !important;
  }
  #modal > .modal-panel > .modal-content {
    padding: 8px !important;        /* antes 10px */
    gap: 8px !important;            /* antes 10px */
    min-height: 200px !important;   /* antes 220px */
  }
  #modal .modal-thumb {
    min-height: 160px !important;   /* antes 180px */
    background-position: center 18% !important; /* antes 20% */
  }
  #modal .modal-body { max-height: calc(84vh - 68px) !important; } /* antes 88vh */
  #modal .modal-actions .btn { width: 100% !important; min-width: 0 !important; padding: 10px 12px !important; }
  #modal .modal-close { right: 10px !important; top: 10px !important; }
}

@media (max-width: 400px) {
  #modal > .modal-panel {
    width: 94% !important;          /* antes 96% */
    max-width: 94% !important;      /* antes 96% */
    height: auto !important;
    max-height: 82vh !important;    /* antes 86vh */
    border-radius: 10px !important;
  }
  #modal > .modal-panel > .modal-content {
    padding: 6px !important;        /* antes 8px */
    gap: 6px !important;            /* antes 8px */
    min-height: 180px !important;   /* antes 200px */
  }
  #modal .modal-thumb { min-height: 140px !important; } /* antes 160px */
  #modal > .modal-panel > .modal-content > .modal-body { max-height: none; }
  #modal .modal-body h3 { font-size: 17px !important; } /* antes 18px */
  #modal .modal-desc,
  #modal .modal-muted,
  #modal .session .info,
  #modal .session .time { font-size: 12px !important; } /* antes 12.5px */
}

/* ---------- ADMIN UI (corrected) ---------- */
.admin-modal{
  position:fixed;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  background:rgba(2,6,10,0.72);
  z-index:110000;
  padding:22px;
  backdrop-filter:blur(10px);
}
.admin-modal.hidden{ display:none }

.admin-modal .admin-panel,
.admin-panel{
  width:100%;
  max-width:540px;
  background: linear-gradient(180deg,#071018,#02030a);
  border-radius:12px;
  padding:22px;
  border:1px solid rgba(255,255,255,0.04);
  box-shadow:0 40px 120px rgba(0,0,0,0.6);
  position:relative;
  display:flex;
  flex-direction:column;
  gap:10px;
  overflow:hidden;
}

.admin-close{
  position:absolute;
  right:12px;
  top:12px;
  background:transparent;
  border:none;
  color:var(--muted);
  font-size:18px;
  cursor:pointer;
}

.admin-form{display:flex;flex-direction:column;gap:12px}
.admin-form label{display:block;font-size:14px;color:var(--muted);line-height:1.2}
.admin-form input, .admin-form textarea{
  width:100%;
  padding:12px 12px;
  border-radius:10px;
  border:1px solid rgba(255,255,255,0.06);
  background:rgba(255,255,255,0.02);
  color:inherit;
  outline:none;
  box-shadow: inset 0 1px 0 rgba(255,255,255,0.01);
  font-size:14px;
}
.admin-form .admin-actions{ display:flex; gap:12px; justify-content:flex-end; margin-top:6px; }
.admin-note{font-size:13px;color:var(--muted);margin-top:6px}
/* =========================
   Admin drawer: centered & larger
   Substituir o bloco .admin-drawer existente por este
   ========================= */
.admin-drawer{
  position:fixed;
  top:50%;
  left:50%;
  transform:translate(-50%,-50%); /* centraliza em X e Y */
  width: min(920px, 94%);         /* até 920px ou 94% da tela */
  max-width: calc(var(--container) - 40px);
  max-height: 86vh;               /* não ultrapassa viewport */
  height: auto;
  background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.03));
  border-radius:14px;             /* mais arredondado para combinar */
  padding:18px;
  border:1px solid rgba(255,255,255,0.03);
  box-shadow:0 40px 140px rgba(0,0,0,0.65);
  z-index:199990;
  overflow:auto;                  /* scroll interno se necessário */
  display:block;                  /* controle via .hidden */
}

/* mantém o .hidden funcionando */
.admin-drawer.hidden{ display:none; }

/* garante que o .admin-panel interno use 100% da largura disponível
   (o .admin-panel global tinha max-width:540px — isso sobrescreve
    só quando dentro do drawer) */
.admin-drawer > .admin-panel {
  max-width: none;
  width: 100%;
  padding: 12px 14px;
  border-radius: 10px;
  box-shadow: none; /* evita sombra dupla com o drawer */
}

/* opcional: ajuste fino para telas médias */
@media(max-width:1100px){
  .admin-drawer{ width: min(760px, 94%); max-height:88vh; padding:14px; }
}

/* mantém seu comportamento atual em telas pequenas (você já tinha isso) */
@media(max-width:720px){
  .admin-drawer{ position:static; width:100%; height:auto; margin-top:12px; transform:none; top:auto; left:auto; }
}

/* schedule / editor bits kept */
.sched-head{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}
.sched-list{display:flex;flex-direction:column;gap:8px}
.sched-item{display:flex;gap:8px;align-items:center}
.sched-item input{flex:1}
.admin-list{display:flex;flex-direction:column;gap:8px;margin-top:8px}
.admin-item{display:flex;justify-content:space-between;align-items:center;padding:10px;border-radius:8px;background:rgba(255,255,255,0.02);border:1px solid rgba(255,255,255,0.03)}
.admin-item .meta{font-size:13px}

/* IMAGE PREVIEW */
.image-preview{display:flex;flex-direction:column;gap:8px;margin-top:6px}
#evPreview{width:100%;max-height:160px;object-fit:cover;border-radius:8px;border:1px solid rgba(255,255,255,0.03);display:none;cursor:pointer}
.preview-actions{display:flex;gap:8px;align-items:center}

/* ---------- IMAGE EDITOR OVERLAY (added) ---------- */
/* ... (mantive todo o seu CSS original acima, aqui inclui só a parte do editor ajustada) */

/* ---------- IMAGE EDITOR OVERLAY (ajustado) ---------- */
#imgEditor {
  position:fixed;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  z-index:240000;
  background:rgba(2,6,10,0.72);
  padding:20px;
}
#imgEditor.hidden { display:none; }
#imgEditor .editor-panel {
  width:960px;
  max-width:96%;
  background:linear-gradient(180deg,#071218,#02030a);
  border-radius:14px;
  padding:14px;
  box-shadow:0 60px 160px rgba(0,0,0,0.9);
  display:flex;
  gap:12px;
  align-items:flex-start;
  flex-wrap:nowrap;
}
.editor-viewport {
  /* Dimensões iniciais - serão substituídas dinamicamente pelo JS para serem maiores que o card */
  width:640px;
  height:360px;
  background:linear-gradient(180deg,#0b1926,#06101a);
  border-radius:10px;
  overflow:hidden;
  position:relative;
  touch-action:none;
  border:1px solid rgba(255,255,255,0.04);
}
.editor-viewport img {
  position:absolute;
  top:0; left:0;
  transform-origin:0 0;
  will-change: transform;
  cursor:grab;
  user-select:none;
  -webkit-user-drag:none;
  -moz-user-select:none;
}
.editor-controls{display:flex;flex-direction:column;gap:8px;min-width:300px}
.editor-controls .control-row{display:flex;gap:8px;align-items:center}
.editor-controls label{font-size:13px;color:var(--muted)}
.editor-controls input[type="range"]{width:100%}
.editor-actions{display:flex;gap:8px;justify-content:flex-end;margin-top:6px}
.editor-actions .btn{min-width:110px}
.editor-hint{font-size:13px;color:var(--muted);margin-top:8px}

/* Responsividade: reduzir painel em telas pequenas */
@media(max-width:900px){
  #imgEditor .editor-panel { flex-direction:column; align-items:center; padding:10px; }
  .editor-controls{min-width:100%; width:100%}
  .editor-viewport{ width:100%; max-width:720px; height:calc( (100% / 16) * 9 ); } /* fallback aspect */
}

/* ---------- FOOTER ---------- */
.site-footer{padding:24px 0;color:var(--muted);text-align:center;border-top:1px solid rgba(255,255,255,0.02)}

/* ---------- RESPONSIVE ---------- */
@media(max-width:1100px){ .agenda-grid{grid-template-columns:repeat(2,1fr)} .hero-panel{grid-template-columns:1fr 260px} .search input{min-width:220px} .admin-drawer{width:360px} }
@media(max-width:720px){
  :root{--hero-height:480px}
  .site-hero{padding-bottom:10px}
  .hero-panel{grid-template-columns:1fr;padding:14px;gap:10px}
  .hero-right{align-items:flex-start}
  .agenda-grid{grid-template-columns:1fr}
  .content-panel{padding:14px}
  #modal > .modal-panel > .modal-content{ grid-template-columns: 1fr; }
  #modal .modal-thumb{min-height:160px}
  .admin-drawer{position:static;width:100%;height:auto;margin-top:12px}
  .admin-modal .admin-panel, .admin-panel { max-width:96%; padding:16px; }
}

/* ===== Mobile refinements (768 / 600 / 400) — only for events ===== */
@media (max-width: 768px) {
  .container { padding: 0 14px; }
  .hero-panel { grid-template-columns: 1fr; gap: 12px; padding: 14px; }
  .hero-logo { height: 56px; }
  .hero-title { font-size: 28px; }
  .hero-text { font-size: 14px; }
  .hero-actions { gap: 10px; flex-wrap: wrap; }

  .hero-right { align-items: flex-start; }
  .hero-stats { display: flex; gap: 10px; flex-wrap: wrap; }

  .controls-row { flex-direction: column; align-items: stretch; gap: 10px; }
  .search input { width: 100%; min-width: 0; }
  .filters { width: 100%; gap: 8px; flex-wrap: wrap; }
  .select-wrap { flex: 1 1 100%; }
  .select-wrap select { width: 100%; min-width: 0; }

  .agenda-grid { grid-template-columns: repeat(2, 1fr); }
  .card-thumb { height: 150px; }             /* antes 200px */
  .card-body { padding: 10px; }              /* antes 14px */
  .card-footer { padding: 8px 10px; }        /* antes 10px 14px */
  .city { font-size: 12px; }                 /* -~8% */
  .date { font-size: 11px; }
  .desc { font-size: 13px; }
  .card-footer .btn { padding: 9px 12px; font-size: 13px; }
}

@media (max-width: 600px) {
  .hero-title { font-size: 24px; }
  .hero-actions { flex-direction: column; align-items: stretch; }
  .controls-row { gap: 12px; }
  .filters { flex-direction: column; }
  .select-wrap { width: 100%; }

  .agenda-grid { grid-template-columns: 1fr; }
  .card { min-height: 0; max-width: 100%; width: 350px; }
  .card-thumb { height: 135px; }             /* antes 180px */
  .card-body { padding: 9px; }
  .card-footer { padding: 8px 10px; }
  .city { font-size: 12px; }
  .date { font-size: 11px; }
  .desc { font-size: 13px; }
  .card-footer .btn { padding: 8px 12px; font-size: 13px; }
}

@media (max-width: 400px) {
  .content-panel { padding: 12px; }
  .hero-title { font-size: 22px; }
  .hero-text { font-size: 13px; }
  .card-thumb { height: 150px; background-position: center 15%;}             /* antes 150px */
  .card-body { padding: 8px; }
  .card-footer { padding: 8px; }
  .city { font-size: 12px; }
  .date { font-size: 11px; }
  .desc { font-size: 13px; }
  .card-footer .btn { padding: 8px 10px; font-size: 12.5px; }
  .hero-stats { gap: 8px; }
}

/* Mobile: ajustar posição das hero-layers para subir a imagem de fundo */
@media (max-width: 768px) {
  .hero-layer.hero-bg,
  .hero-image {
    background-position: center 8% !important;
  }
  .site-hero { background-position: center 8% !important; }
}

@media (max-width: 600px) {
  .hero-layer.hero-bg,
  .hero-image {
    background-position: center top !important;
  }
  .site-hero { background-position: center top !important; }
}

@media (max-width: 400px) {
  .hero-layer.hero-bg,
  .hero-image {
    background-position: center top !important;
    background-size: cover !important;
  }
  .site-hero { background-position: center top !important; }
}

/* small scrollbar styling */
#modal .modal-body::-webkit-scrollbar{ width:12px; height:10px; }
#modal .modal-body::-webkit-scrollbar-thumb{ background: rgba(255,255,255,0.06); border-radius:8px; border: 2px solid transparent; background-clip: padding-box; }

*[style*="max-width:0"]{ max-width: none !important; }
/* Destaque para o botão "Voltar ao Início" no hero do events */
.hero-actions a[href$="index.html"].btn.ghost {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  background: linear-gradient(180deg, #9D7D56, #8c6f4d) !important;
  color: #fff !important;
  border: 1px solid rgba(255,255,255,0.14) !important;
  box-shadow:
    0 12px 28px rgba(0,0,0,0.55),
    0 0 0 1px rgba(157,125,86,0.28) inset,
    0 0 0 6px rgba(157,125,86,0.12);
  text-shadow: 0 1px 0 rgba(0,0,0,0.25);
  font-weight: 900;
  padding: 12px 18px !important;
  border-radius: 999px;
  transition: transform 160ms ease, box-shadow 160ms ease, filter 160ms ease;
}
.hero-actions a[href$="index.html"].btn.ghost::before {
  content: "←";
  font-weight: 800;
  opacity: .95;
}

.hero-actions a[href$="index.html"].btn.ghost:hover,
.hero-actions a[href$="index.html"].btn.ghost:focus {
  transform: translateY(-2px) scale(1.02);
  filter: brightness(1.08);
  box-shadow:
    0 16px 36px rgba(0,0,0,0.6),
    0 0 0 1px rgba(157,125,86,0.35) inset,
    0 0 0 8px rgba(157,125,86,0.16);
  outline: none;
}

.hero-actions a[href$="index.html"].btn.ghost:active {
  transform: translateY(0) scale(0.99);
  filter: brightness(0.98);
}

/* Mobile: mais área de toque e legibilidade */
@media (max-width: 600px) {
  .hero-actions a[href$="index.html"].btn.ghost {
    align-self: flex-start !important;
    width: auto !important;
    max-width: none !important;
    min-width: 0 !important;
    padding: 6px 10px !important;
    font-size: 13px !important;
    border-radius: 10px !important;
    margin-left: 10px !important;   /* encosta no canto esquerdo com respiro */
    margin-right: 0 !important;
  }
}

@media (max-width: 400px) {
  .hero-actions a[href$="index.html"].btn.ghost {
    align-self: flex-start !important;
    width: auto !important;
    max-width: none !important;
    min-width: 0 !important;
    padding: 5px 8px !important;
    font-size: 12.5px !important;
    border-radius: 10px !important;
    margin-left: 8px !important;    /* ligeiro respiro à esquerda */
    margin-right: 0 !important;
  }
}

/* ---------- NOVAS REGRAS PARA MOBILE ---------- */
@media (max-width: 600px) {
  .hero-right { order: 2; }              /* stats primeiro */
  .hero-actions { order: 3; margin-top: 8px; } /* ações abaixo dos stats */

  .hero-actions a[href$="index.html"].btn.ghost {
    align-self: flex-start !important;
    width: auto !important;
    max-width: none !important;
    min-width: 0 !important;
    padding: 6px 10px !important;
    font-size: 13px !important;
    border-radius: 10px !important;
    margin-left: 10px !important;
    margin-right: 0 !important;
  }

  .agenda-grid {
    justify-items: center; /* centraliza cada item na coluna única */
  }

  .card {
    margin: 0 auto;        /* garante o centro mesmo com width fixo */
  }
}

@media (max-width: 400px) {
  .hero-right { order: 2; }
  .hero-actions { order: 3; margin-top: 6px; }

  .hero-actions a[href$="index.html"].btn.ghost {
    align-self: flex-start !important;
    width: auto !important;
    max-width: none !important;
    min-width: 0 !important;
    padding: 5px 8px !important;
    font-size: 12.5px !important;
    border-radius: 10px !important;
    margin-left: 8px !important;
    margin-right: 0 !important;
  }
}

/* ---------- NOVO: admin-style baseado no seu snippet (escopado) ---------- */
/* eu mantenho o resto do site inalterado — este bloco afeta apenas o painel/admin-modal */
.admin-modal .admin-panel {
  width: 350px;
  margin: 0;
  background: #161b22;
  padding: 30px;
  border-radius: 12px;
  box-shadow: 0 0 20px rgba(0,255,155,0.3);
  border: 1px solid rgba(0,255,155,0.06);
}

.admin-modal .admin-panel h1,
.admin-modal .admin-panel h3 {
  text-align: center;
  margin: 0 0 12px 0;
  color: #00ff9b;
  font-weight: 700;
}

.admin-modal .admin-panel form {
  display: flex;
  flex-direction: column;
}

.admin-modal .admin-panel label {
  margin-top: 10px;
  margin-bottom: 6px;
  font-size: 14px;
  color: #cdefdc;
}

.admin-modal .admin-panel input[type="text"],
.admin-modal .admin-panel input[type="password"],
.admin-modal .admin-panel input[type="file"],
.admin-modal .admin-panel textarea {
  padding: 10px;
  border: none;
  border-radius: 6px;
  margin-bottom: 10px;
  outline: none;
  background: #0b1114;
  color: #e9fff4;
  border: 1px solid rgba(255,255,255,0.03);
}

.admin-modal .admin-panel button[type="submit"],
.admin-modal .admin-panel .btn-primary {
  padding: 12px;
  background-color: #00ff9b;
  border: none;
  border-radius: 6px;
  cursor: pointer;
  font-weight: bold;
  font-size: 16px;
  color: #000;
  transition: 0.15s;
}

.admin-modal .admin-panel button[type="button"],
.admin-modal .admin-panel .btn.ghost {
  padding: 10px;
  background: transparent;
  border-radius: 6px;
  border: 1px solid rgba(255,255,255,0.04);
  color: #cdefdc;
  cursor: pointer;
}

.admin-modal .admin-panel button[type="submit"]:hover,
.admin-modal .admin-panel .btn-primary:hover {
  background-color: #00d07f;
}

/* Status message */
#statusMsg { margin-top: 12px; text-align:center; font-weight:700; color:#bfffe0; }

/* Ajustes de preview da imagem no mesmo estilo */
.admin-modal .image-preview { margin-top:8px; display:block; }
.admin-modal #evPreview { display:block; width:100%; max-height:160px; object-fit:cover; border-radius:8px; }

/* Small: quando o login for exibido, escondemos o admin-drawer */
.admin-drawer.hidden { display:none; }

/* evita sobrescrever estilos do resto do site */
  </style>
</head>
<body>
  <main class="page">

    <!-- HERO -->
    <header class="site-hero">
      <div class="hero-layer hero-bg hero-bg-1" style="background-image:url('Imagens/nov.jpeg')"></div>
      <div class="hero-layer hero-bg hero-bg-2" style="background-image:url('Imagens/nov2.jpeg')"></div>
      <div class="hero-overlay"></div>
      <div class="hero-sweep" aria-hidden="true"></div>

      <div class="hero-shapes" aria-hidden="true"></div>

      <div class="hero-panel container">
        <div class="hero-left">
          <img src="Imagens/lider1.png" alt="Líder Pleno" class="hero-logo" aria-hidden="true">
          <h1 class="hero-title">
            <span class="h-large">Transforme-se</span>
            <span class="h-accent">— inspire o mundo</span>
          </h1>
          <p class="hero-text">Programas presenciais e palestras com ferramentas práticas para líderes que querem resultados reais.</p>

          <div class="hero-actions">
            <a href="index.html" class="btn ghost">Voltar ao Início</a>
            <button id="adminToggle" class="btn ghost">Admin</button>
          </div>
        </div>

        <div class="hero-right">
          <div class="hero-stats">
            <div class="stat"><div class="stat-num">+1200</div><div class="stat-label">Participantes</div></div>
            <div class="stat"><div class="stat-num">+45</div><div class="stat-label">Eventos</div></div>
            <div class="stat"><div class="stat-num">4.9</div><div class="stat-label">Avaliação média</div></div>
          </div>

          <div class="hero-note">Próximo: <strong>Curitiba — 05 a 07 de Setembro</strong></div>
        </div>
      </div>
    </header>

    <!-- MAIN CONTENT PANEL -->
    <section class="content-panel container">
      <div class="controls-row controls-top">
        <div class="search">
          <label for="searchInput" class="sr-only">Pesquisar evento</label>
          <input id="searchInput" placeholder="Pesquisar por cidade, palavra-chave..." />
        </div>

        <div class="filters" role="region" aria-label="Filtros">
          <div class="select-wrap">
            <select id="cityFilter" aria-label="Filtrar por cidade">
              <option value="">Todas as cidades</option>
            </select>
          </div>

          <div class="select-wrap">
            <select id="dateFilter" aria-label="Filtrar por mês">
              <option value="">Todos os meses</option>
              <option value="09">Setembro</option>
              <option value="11">Novembro</option>
              <option value="12">Dezembro</option>
            </select>
          </div>

          <button id="clearFilters" class="btn ghost" aria-label="Limpar filtros">Limpar</button>
        </div>
      </div>

      <div class="agenda-grid-wrap">
        <div id="agendaGrid" class="agenda-grid" role="list"></div>
      </div>
    </section>

    <!-- ADMIN: login modal -->
    <div id="adminLogin" class="admin-modal hidden" role="dialog" aria-hidden="true">
      <div class="admin-panel">
        <button class="admin-close" id="adminClose" aria-label="Fechar">✕</button>
        <h3>Área Administrativa — Login</h3>
        <form id="loginForm" class="admin-form">
          <label>Usuário
            <input id="adminUser" type="text" placeholder="admin" required>
          </label>
          <label>Senha
            <input id="adminPass" type="password" placeholder="senha" required>
          </label>
          <div class="admin-actions">
            <button type="submit" class="btn btn-primary">Entrar</button>
            <button type="button" id="adminCancel" class="btn ghost">Cancelar</button>
          </div>
        </form>
        <div id="statusMsg" aria-live="polite"></div>
      </div>
    </div>

    <!-- ADMIN PANEL (central modal) -->
    <aside id="adminDrawer" class="admin-drawer hidden" role="dialog" aria-modal="true" aria-hidden="true">
      <div class="admin-panel">
        <div class="admin-header" style="display:flex;justify-content:space-between;align-items:center;gap:8px;">
          <h3>Painel Admin</h3>
          <div class="admin-header-actions" style="display:flex;gap:8px;">
            <button id="adminLogout" class="btn ghost">Logout</button>
            <button id="adminCloseDrawer" class="btn ghost" aria-label="Fechar painel">Fechar</button>
          </div>
        </div>

        <div class="admin-body" style="display:flex;flex-direction:column;gap:16px;margin-top:8px;">
          <section class="admin-section">
            <h4>Adicionar / Editar Evento</h4>
            <form id="eventForm" class="admin-form">
              <input type="hidden" id="evId" value="">
              <label>Título / Cidade
                <input id="evCity" type="text" placeholder="CURITIBA/PR" required>
              </label>

              <label>Datas (rótulo)
                <input id="evDateLabel" type="text" placeholder="05, 06 e 07 de Setembro" required>
              </label>

              <label>Mês (MM)
                <input id="evMonth" type="text" placeholder="09" maxlength="2" required>
              </label>

              <label>Local / Venue
                <input id="evVenue" type="text" placeholder="TREINAMENTO PRESENCIAL" required>
              </label>

              <label>Preço / Call-to-action
                <input id="evPrice" type="text" placeholder="GARANTA A SUA VAGA!" required>
              </label>

              <!-- IMAGE: accepts URL or upload file -->
              <label>Imagem (URL ou upload)
                <input id="evImg" type="text" placeholder="Imagens/banner1.JPG ou https://..." >
              </label>
              <label>OU faça upload (jpg/png) — escolha um arquivo
                <input id="evFile" type="file" accept="image/*">
              </label>

              <div class="image-preview">
                <img id="evPreview" alt="Preview da imagem" src="" />
                <div class="preview-actions">
                  <button id="editImage" type="button" class="btn ghost" title="Editar imagem (arrastar/zoom)">Editar imagem</button>
                  <button id="downloadImg" type="button" class="btn ghost">Exportar imagem</button>
                  <button id="clearImage" type="button" class="btn ghost">Remover imagem</button>
                </div>
                <small class="admin-note">Ao subir um arquivo, ele será convertido para imagem embutida (base64) e salvo no evento.</small>
              </div>

              <label>Descrição
                <textarea id="evDesc" rows="3" placeholder="Descrição curta do evento"></textarea>
              </label>

              <div class="schedule-editor">
                <div class="sched-head">
                  <strong>Programação</strong>
                  <button id="addSched" type="button" class="btn ghost">Adicionar item</button>
                </div>
                <div id="schedList" class="sched-list"></div>
              </div>

              <div class="admin-actions">
                <button id="saveEvent" type="submit" class="btn btn-primary">Salvar evento</button>
                <button id="resetForm" type="button" class="btn ghost">Limpar</button>
              </div>
            </form>
          </section>

          <section class="admin-section">
            <h4>Eventos existentes</h4>
            <div id="adminList" class="admin-list"></div>
          </section>
        </div>
      </div>
    </aside>

    <div id="modal" class="modal hidden" role="dialog" aria-hidden="true" aria-modal="true"></div>

    <footer class="site-footer">
      <div class="container">
        <p>© <span id="year"></span> Paulo Carrion — Todos os direitos reservados.</p>
      </div>
    </footer>
  </main>

<!-- Optional external modules (leave as-is if you use them) -->
<script type="module" src="firebase-init.js"></script>
<script type="module" src="events.js"></script>

<!-- Admin JS: login + CRUD localStorage + image preview (coloquei after events.js) -->
<script>
document.addEventListener('DOMContentLoaded', function () {
  /* events-admin.js — integra o painel admin com login simples e CRUD localStorage */
  (function(){
    // selectors
    const adminToggle = document.getElementById('adminToggle');
    const adminLogin = document.getElementById('adminLogin');
    const adminClose = document.getElementById('adminClose');
    const adminCancel = document.getElementById('adminCancel');
    const loginForm = document.getElementById('loginForm');
    const adminDrawer = document.getElementById('adminDrawer');
    const adminLogout = document.getElementById('adminLogout');
    const adminCloseDrawer = document.getElementById('adminCloseDrawer');
    const statusMsg = document.getElementById('statusMsg') || (() => {
      const el = document.createElement('div'); el.id='statusMsg'; document.body.appendChild(el); return el;
    })();

    const evForm = document.getElementById('eventForm');
    const evId = document.getElementById('evId');
    const evCity = document.getElementById('evCity');
    const evDateLabel = document.getElementById('evDateLabel');
    const evMonth = document.getElementById('evMonth');
    const evVenue = document.getElementById('evVenue');
    const evPrice = document.getElementById('evPrice');
    const evImg = document.getElementById('evImg');
    const evFile = document.getElementById('evFile');
    const evPreview = document.getElementById('evPreview');
    const evDesc = document.getElementById('evDesc');
    const schedList = document.getElementById('schedList');
    const addSched = document.getElementById('addSched');
    const adminList = document.getElementById('adminList');
    const agendaGrid = document.getElementById('agendaGrid');
    const saveEventBtn = document.getElementById('saveEvent');
    const resetFormBtn = document.getElementById('resetForm');
    const clearImageBtn = document.getElementById('clearImage');
    const downloadImgBtn = document.getElementById('downloadImg');
    const editImageBtn = document.getElementById('editImage');

    // simple credentials (client-side only!)
    const CRED_USER = 'admin';
    const CRED_PASS = 'senha';

    // helpers
    function showLogin(){ adminLogin.classList.remove('hidden'); adminLogin.setAttribute('aria-hidden','false'); }
    function hideLogin(){ adminLogin.classList.add('hidden'); adminLogin.setAttribute('aria-hidden','true'); }
    function showDrawer(){ adminDrawer.classList.remove('hidden'); adminDrawer.setAttribute('aria-hidden','false'); }
    function hideDrawer(){ adminDrawer.classList.add('hidden'); adminDrawer.setAttribute('aria-hidden','true'); }

    function setStatus(text, ok=true){
      statusMsg.textContent = text;
      statusMsg.style.color = ok ? '#bfffe0' : '#ffb2b2';
      if(ok){
        statusMsg.style.opacity = '1';
      }
      setTimeout(()=>{ statusMsg.textContent = ''; }, 3500);
    }

    // localStorage key
    const LS_KEY = 'paulo_events_v1';
    function loadEvents(){ try{ return JSON.parse(localStorage.getItem(LS_KEY) || '[]'); }catch(e){ return []; } }
    function saveEvents(list){ localStorage.setItem(LS_KEY, JSON.stringify(list)); }

    // render grid cards
    function renderGrid(){
      const list = loadEvents();
      agendaGrid.innerHTML = '';
      if(!list.length){
        agendaGrid.innerHTML = '<div style="grid-column:1/-1;color:var(--muted);padding:40px;text-align:center">Nenhum evento cadastrado.</div>';
        return;
      }
      list.forEach(ev => {
        const card = document.createElement('div');
        card.className = 'card';
        card.innerHTML = `
          <div class="card-thumb" style="background-image:url('${ev.image||''}');"></div>
          <div class="card-body">
            <div class="meta">
              <div>
                <div class="city">${escapeHtml(ev.city||'')}</div>
                <div class="date">${escapeHtml(ev.dateLabel||'')}</div>
              </div>
              <div class="badge">${escapeHtml(ev.venue||'')}</div>
            </div>
            <div class="desc">${escapeHtml(ev.desc||'')}</div>
          </div>
          <div class="card-footer">
            <button class="btn" data-action="view" data-id="${ev.id}">Ver programação</button>
            <div style="display:flex;gap:8px;min-width:140px;">
              <div class="price">${escapeHtml(ev.price||'')}</div>
            </div>
          </div>
        `;
        agendaGrid.appendChild(card);
        // event click — view -> open modal (use existing #modal if available)
        const viewBtn = card.querySelector('button[data-action="view"]');
        viewBtn?.addEventListener('click', ()=> openEventModal(ev));
      });
    }

    function openEventModal(ev){
      // use existing modal markup (id="modal") if present; else alert
      const bigModal = document.getElementById('modal');
      if(!bigModal) {
        alert(ev.city + '\n' + (ev.dateLabel||'') + '\n' + (ev.desc||''));
        return;
      }
      bigModal.innerHTML = '';
      const panel = document.createElement('div');
      panel.className = 'modal-panel';
      panel.innerHTML = `
        <div class="modal-content">
          <div class="modal-thumb" style="background-image:url('${ev.image||''}')"></div>
          <div class="modal-body">
            <button class="modal-close">Fechar</button>
            <h3>${escapeHtml(ev.city||'')}</h3>
            <div class="modal-desc">${escapeHtml(ev.desc||'')}</div>
            <div style="margin-top:8px"><strong>Local:</strong> ${escapeHtml(ev.venue||'')}</div>
            <div><strong>Datas:</strong> ${escapeHtml(ev.dateLabel||'')}</div>
            <div style="margin-top:8px"><strong>Programação:</strong>
              <ul>${(ev.schedule||[]).map(s => `<li>${escapeHtml(s)}</li>`).join('')}</ul>
            </div>
            <div style="margin-top:12px"><button class="btn ghost modal-close-2">Fechar</button></div>
          </div>
        </div>
      `;
      bigModal.appendChild(panel);
      bigModal.classList.remove('hidden');
      bigModal.classList.add('open');
      bigModal.setAttribute('aria-hidden','false');

      bigModal.querySelectorAll('.modal-close, .modal-close-2').forEach(b => {
        b.addEventListener('click', ()=> {
          bigModal.classList.add('hidden');
          bigModal.classList.remove('open');
          bigModal.setAttribute('aria-hidden','true');
        });
      });
    }

    // escape helper
    function escapeHtml(s){ if(!s) return ''; return String(s).replace(/[&<>"']/g, (m)=>({ '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;' }[m])); }

    // admin list render (mini CRUD)
    function renderAdminList(){
      const list = loadEvents();
      adminList.innerHTML = '';
      if(!list.length){ adminList.innerHTML = '<div style="color:var(--muted);padding:8px">Sem eventos.</div>'; return; }
      list.forEach(ev => {
        const item = document.createElement('div');
        item.className = 'admin-item';
        item.innerHTML = `
          <div class="meta">
            <div style="font-weight:800">${escapeHtml(ev.city)}</div>
            <div style="font-size:12px;color:var(--muted)">${escapeHtml(ev.dateLabel)}</div>
          </div>
          <div style="display:flex;gap:8px">
            <button class="btn ghost edit" data-id="${ev.id}">Editar</button>
            <button class="btn ghost del" data-id="${ev.id}">Excluir</button>
          </div>
        `;
        adminList.appendChild(item);

        item.querySelector('.edit').addEventListener('click', ()=> loadEventToForm(ev.id));
        item.querySelector('.del').addEventListener('click', ()=> {
          if(!confirm('Excluir evento?')) return;
          const newList = loadEvents().filter(x => x.id !== ev.id);
          saveEvents(newList);
          renderAdminList(); renderGrid();
          setStatus('Evento excluído');
        });
      });
    }

    function loadEventToForm(id){
      const list = loadEvents();
      const ev = list.find(x => x.id === id);
      if(!ev) return;
      evId.value = ev.id;
      evCity.value = ev.city||'';
      evDateLabel.value = ev.dateLabel||'';
      evMonth.value = ev.month||'';
      evVenue.value = ev.venue||'';
      evPrice.value = ev.price||'';
      evImg.value = ev.image && ev.image.startsWith('data:') ? '' : (ev.image||''); // if base64, keep empty url input
      evPreview.src = ev.image || '';
      evPreview.style.display = ev.image ? 'block' : 'none';
      evDesc.value = ev.desc||'';
      // schedule
      schedList.innerHTML = '';
      (ev.schedule || []).forEach(s => {
        const row = document.createElement('div'); row.className='sched-item';
        row.innerHTML = `<input type="text" class="sched-input" value="${escapeHtml(s)}"><button type="button" class="btn ghost remove-sched">✕</button>`;
        schedList.appendChild(row);
        row.querySelector('.remove-sched').addEventListener('click', ()=> row.remove());
      });
      setStatus('Evento carregado para edição');
    }

    // form submit
    evForm?.addEventListener('submit', (e)=>{
      e.preventDefault();
      const list = loadEvents();
      const id = evId.value || ('evt_' + Date.now());
      // gather schedule
      const schedule = Array.from(schedList.querySelectorAll('.sched-item input')).map(i => i.value).filter(Boolean);
      // image: either evPreview.src (base64 or url) or evImg.value if provided
      let image = evPreview.src || (evImg.value || '');
      // if evPreview.src is empty but evImg.value has url -> use it
      if(!image && evImg.value) image = evImg.value.trim();

      const payload = {
        id,
        city: evCity.value.trim(),
        dateLabel: evDateLabel.value.trim(),
        month: evMonth.value.trim(),
        venue: evVenue.value.trim(),
        price: evPrice.value.trim(),
        image: image || '',
        desc: evDesc.value.trim(),
        schedule
      };

      // if exists, replace; else push
      const existsIndex = list.findIndex(x => x.id === id);
      if(existsIndex >= 0) list[existsIndex] = payload;
      else list.unshift(payload);
      saveEvents(list);
      renderAdminList(); renderGrid(); resetForm();
      setStatus('Evento salvo com sucesso');
    });

    // reset form
    function resetForm(){
      evForm.reset();
      evId.value = '';
      evPreview.src = '';
      evPreview.style.display = 'none';
      schedList.innerHTML = '';
    }
    resetFormBtn?.addEventListener('click', resetForm);
    clearImageBtn?.addEventListener('click', ()=>{
      evPreview.src = ''; evPreview.style.display = 'none'; evImg.value = '';
      setStatus('Imagem removida');
    });

    // download image
    downloadImgBtn?.addEventListener('click', ()=>{
      if(!evPreview.src) { setStatus('Sem imagem para exportar', false); return; }
      const a = document.createElement('a');
      a.href = evPreview.src;
      a.download = (evCity.value || 'imagem_evento') + '.png';
      document.body.appendChild(a);
      a.click();
      a.remove();
    });

    // file upload -> base64 preview
    evFile?.addEventListener('change', (ev)=>{
      const f = ev.target.files && ev.target.files[0];
      if(!f) return;
      const reader = new FileReader();
      reader.onload = function(evt){
        evPreview.src = evt.target.result;
        evPreview.style.display = 'block';
        evImg.value = ''; // clear URL input
        setStatus('Imagem carregada');
      }
      reader.readAsDataURL(f);
    });

    // image URL input -> preview
    evImg?.addEventListener('change', (e)=>{
      const url = e.target.value.trim();
      if(!url){ evPreview.src=''; evPreview.style.display='none'; return; }
      evPreview.src = url;
      evPreview.style.display = 'block';
    });

    // add schedule item
    addSched?.addEventListener('click', ()=>{
      const row = document.createElement('div'); row.className='sched-item';
      row.innerHTML = `<input type="text" class="sched-input" placeholder="09:00 — Abertura / Palestra"><button type="button" class="btn ghost remove-sched">✕</button>`;
      schedList.appendChild(row);
      row.querySelector('.remove-sched').addEventListener('click', ()=> row.remove());
    });

    // small image edit action (just toggles a zoom in new window as placeholder)
    editImageBtn?.addEventListener('click', ()=>{
      if(!evPreview.src){ setStatus('Sem imagem para editar', false); return; }
      // open simple editor in new window (user can use browser tools) — placeholder
      const w = window.open('');
      w.document.write(`<img src="${evPreview.src}" style="max-width:100%;">`);
    });

    // admin actions: open login
    adminToggle?.addEventListener('click', ()=> {
      // if already logged in, open drawer directly
      if(localStorage.getItem('adminLogged') === '1'){ showDrawer(); return; }
      showLogin();
    });
    adminClose?.addEventListener('click', hideLogin);
    adminCancel?.addEventListener('click', hideLogin);

    // handle login form
    loginForm?.addEventListener('submit', (e)=>{
      e.preventDefault();
      const user = document.getElementById('adminUser').value.trim();
      const pass = document.getElementById('adminPass').value.trim();
      if(user === CRED_USER && pass === CRED_PASS){
        localStorage.setItem('adminLogged','1');
        hideLogin();
        showDrawer();
        setStatus('Login efetuado');
        // render admin stuff
        renderAdminList(); renderGrid();
      } else {
        setStatus('Usuário ou senha incorretos', false);
      }
    });

    // logout
    adminLogout?.addEventListener('click', ()=>{
      localStorage.removeItem('adminLogged');
      hideDrawer();
      setStatus('Logout realizado');
    });
    adminCloseDrawer?.addEventListener('click', ()=> hideDrawer());

    // initial render if logged
    if(localStorage.getItem('adminLogged') === '1'){
      showDrawer();
    } else {
      hideDrawer();
    }
    renderGrid();
    renderAdminList();

    // small helper: close login on overlay click (if you want)
    adminLogin?.addEventListener('click', (e)=> { if(e.target === adminLogin) hideLogin(); });

    // expose resetForm to window for debug (optional)
    window._admin_resetForm = resetForm;
  })();
});
</script>

<script>
  // simple year in footer
  document.getElementById('year').textContent = new Date().getFullYear();
</script>

</body>
</html>
